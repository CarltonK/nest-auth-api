model User {
    id                      Int               @id @default(autoincrement())
    emailAddress            String            @unique @db.VarChar(200)
    firstName               String?           @db.VarChar(200)
    lastName                String?           @db.VarChar(200)
    passwordHash            String
    emailVerifiedAt         DateTime?
    emailVerificationToken  String?
    emailVerificationSentAt DateTime?
    passwordResetToken      String?
    passwordResetSentAt     DateTime?
    metadata                Json?
    mfaEnabled              Boolean           @default(false)
    isActive                Boolean           @default(false)
    isLocked                Boolean           @default(false)
    failedAttemptsCount     Int               @default(0)
    passwordChangedAt       DateTime
    lastLoginAt             DateTime?
    createdAt               DateTime          @default(now())
    updatedAt               DateTime          @updatedAt
    auditLog                AuditLog[]
    passwordHistory         PasswordHistory[]
    sessions                Session[]
    authTokens              AuthToken[]
    mfaMethods              MfaMethod[]
}

model AuditLog {
    id        String   @id @default(uuid())
    userId    Int?
    eventType String
    severity  String
    details   Json
    createdAt DateTime @default(now())
    user      User?    @relation(fields: [userId], references: [id])
}

model PasswordHistory {
    id           String   @id @default(uuid())
    userId       Int
    user         User     @relation(fields: [userId], references: [id])
    passwordHash String
    createdAt    DateTime @default(now())
}
